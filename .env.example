# AI-Driven DeFi Yield Rebalancing System
# Environment Variables Template

# ============================================================================
# Network Configuration
# ============================================================================
NETWORK=goerli  # Options: mainnet, goerli, sepolia, local
RPC_URL=https://eth-goerli.g.alchemy.com/v2/YOUR_API_KEY

# ============================================================================
# Blockchain Data Providers
# ============================================================================
# Alchemy (RPC + Enhanced APIs)
ALCHEMY_API_KEY=your_alchemy_api_key
ALCHEMY_WEBHOOK_SECRET=your_webhook_secret

# The Graph (Protocol Indexing)
GRAPH_API_KEY=your_graph_api_key
GRAPH_DEPLOY_KEY=your_deploy_key

# Subgraph URLs
AAVE_SUBGRAPH_URL=https://api.thegraph.com/subgraphs/name/aave/protocol-v3
CURVE_SUBGRAPH_URL=https://api.thegraph.com/subgraphs/name/messari/curve-finance-ethereum
UNISWAP_SUBGRAPH_URL=https://api.thegraph.com/subgraphs/name/uniswap/uniswap-v3

# Dune Analytics
DUNE_API_KEY=your_dune_api_key

# ============================================================================
# Smart Contract Addresses (Goerli Testnet)
# ============================================================================
VAULT_CONTRACT_ADDRESS=0x0000000000000000000000000000000000000000
STRATEGY_HUB_ADDRESS=0x0000000000000000000000000000000000000000
KILL_SWITCH_ADDRESS=0x0000000000000000000000000000000000000000

# Protocol Addresses (Mainnet - for reference)
AAVE_POOL_ADDRESS=0x87870Bca3F3fD6335C3F4ce8392D69350B4fA4E2
CURVE_ROUTER_ADDRESS=0xF0d4c12A5768D806021F80a262B4d39d26C58b8D
UNISWAP_ROUTER_ADDRESS=0xE592427A0AEce92De3Edee1F18E0157C05861564

# ============================================================================
# Private Keys & Signing (NEVER COMMIT ACTUAL KEYS)
# ============================================================================
# Keeper (hot wallet for rebalancing)
KEEPER_PRIVATE_KEY=0x0000000000000000000000000000000000000000000000000000000000000000

# Multi-sig addresses (Gnosis Safe)
MULTISIG_TREASURY_ADDRESS=0x0000000000000000000000000000000000000000
MULTISIG_GOVERNANCE_ADDRESS=0x0000000000000000000000000000000000000000

# AWS KMS (for production)
AWS_KMS_KEY_ID=your_kms_key_id
AWS_REGION=us-east-1

# ============================================================================
# Database Configuration
# ============================================================================
# PostgreSQL (with TimescaleDB)
DB_HOST=localhost
DB_PORT=5432
DB_NAME=defi_yield_db
DB_USER=postgres
DB_PASSWORD=your_secure_password
DB_POOL_SIZE=10

# Database URL (alternative format)
DATABASE_URL=postgresql://postgres:your_secure_password@localhost:5432/defi_yield_db

# ============================================================================
# Redis (Caching)
# ============================================================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=your_redis_password
REDIS_DB=0
REDIS_URL=redis://:your_redis_password@localhost:6379/0

# ============================================================================
# Machine Learning Configuration
# ============================================================================
# Model paths
LSTM_MODEL_PATH=models/lstm_yield_predictor_v1.pth
XGBOOST_MODEL_PATH=models/xgboost_risk_scorer_v1.pkl
PPO_MODEL_PATH=models/ppo_rebalancer_v1.zip

# Training settings
TRAINING_DEVICE=cuda  # Options: cuda, cpu, mps (Apple Silicon)
BATCH_SIZE=64
LEARNING_RATE=0.001
NUM_EPOCHS=100

# Feature engineering
LOOKBACK_WINDOW=30  # Days for LSTM input
PREDICTION_HORIZON=7  # Days to predict ahead

# ============================================================================
# Risk Management
# ============================================================================
# Risk thresholds
MAX_PROTOCOL_RISK_SCORE=70  # 0-100 scale
MIN_LIQUIDITY_RATIO=1.5  # Must be able to exit 1.5x current position
MAX_POSITION_SIZE=0.50  # Maximum 50% in single protocol
MIN_POSITION_SIZE=0.05  # Minimum 5% allocation

# Kill switch thresholds
STABLECOIN_PEG_MIN=0.98  # $0.98
STABLECOIN_PEG_MAX=1.02  # $1.02
TVL_DROP_THRESHOLD=0.30  # 30% drop triggers alert
UTILIZATION_MAX=0.95  # 95% utilization is risky

# ============================================================================
# Gas & Execution Settings
# ============================================================================
# Gas limits
MAX_GAS_PRICE_GWEI=100
GAS_LIMIT_REBALANCE=500000
GAS_BUFFER_MULTIPLIER=1.2

# Slippage
MAX_SLIPPAGE_PERCENT=0.5  # 0.5% for stablecoins
MAX_SLIPPAGE_VOLATILE=2.0  # 2% for volatile pairs

# Rebalancing constraints
MIN_REBALANCE_INTERVAL_HOURS=6  # Minimum 6 hours between rebalances
MAX_REBALANCES_PER_DAY=4
MIN_YIELD_IMPROVEMENT=0.005  # 0.5% improvement required

# MEV protection
USE_FLASHBOTS=true
FLASHBOTS_RPC=https://rpc.flashbots.net

# ============================================================================
# API Configuration
# ============================================================================
API_HOST=0.0.0.0
API_PORT=8000
API_WORKERS=4

# Authentication
API_SECRET_KEY=your_secret_key_change_in_production
JWT_ALGORITHM=HS256
JWT_EXPIRATION_MINUTES=60

# Rate limiting
API_RATE_LIMIT=100  # requests per minute
API_RATE_LIMIT_WINDOW=60  # seconds

# ============================================================================
# Monitoring & Alerting
# ============================================================================
# Prometheus
PROMETHEUS_PORT=9090

# Grafana
GRAFANA_PORT=3000
GRAFANA_ADMIN_PASSWORD=your_grafana_password

# PagerDuty
PAGERDUTY_INTEGRATION_KEY=your_pagerduty_key
PAGERDUTY_ENABLED=true

# Sentry (Error Tracking)
SENTRY_DSN=your_sentry_dsn
SENTRY_ENVIRONMENT=development  # Options: development, staging, production

# Logging
LOG_LEVEL=INFO  # Options: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_FORMAT=json  # Options: json, text

# ============================================================================
# External APIs
# ============================================================================
# CoinGecko (for price data)
COINGECKO_API_KEY=your_coingecko_api_key

# Etherscan (for contract verification)
ETHERSCAN_API_KEY=your_etherscan_api_key

# Tenderly (for simulation)
TENDERLY_ACCESS_KEY=your_tenderly_key
TENDERLY_PROJECT_SLUG=your_project_slug

# ============================================================================
# Feature Flags
# ============================================================================
ENABLE_REBALANCING=false  # Master switch for autonomous rebalancing
ENABLE_KILL_SWITCHES=true  # Enable automated safety triggers
ENABLE_ML_PREDICTIONS=true  # Use ML models vs simple heuristics
ENABLE_RL_AGENT=false  # Use RL for decisions (false = use rule-based)

# Development flags
DEBUG_MODE=true
SIMULATE_TRANSACTIONS=true  # Simulate before executing
DRY_RUN=false  # Log actions without executing

# ============================================================================
# Backtesting Configuration
# ============================================================================
BACKTEST_START_DATE=2024-01-01
BACKTEST_END_DATE=2025-12-31
BACKTEST_INITIAL_CAPITAL=1000000
BACKTEST_DATA_PATH=data/historical/

# ============================================================================
# Notification Channels
# ============================================================================
# Email
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your_email@gmail.com
SMTP_PASSWORD=your_app_password
ALERT_EMAIL_TO=alerts@example.com

# Discord
DISCORD_WEBHOOK_URL=https://discord.com/api/webhooks/YOUR_WEBHOOK

# Telegram
TELEGRAM_BOT_TOKEN=your_telegram_bot_token
TELEGRAM_CHAT_ID=your_chat_id

# ============================================================================
# Cloud & Infrastructure
# ============================================================================
# AWS
AWS_ACCESS_KEY_ID=your_aws_access_key
AWS_SECRET_ACCESS_KEY=your_aws_secret_key
AWS_S3_BUCKET=defi-yield-backups

# Docker
COMPOSE_PROJECT_NAME=defi_yield_rebalancer

# ============================================================================
# Misc
# ============================================================================
TIMEZONE=UTC
APP_VERSION=1.0.0
ENVIRONMENT=development  # Options: development, staging, production
